@startuml
actor Buyer
actor Seller
control "Algo Escrow (Buy)\nStateless" as AlgoEscrow
control "ASA Escrow (Sell)\nStateless" as ASAEscrow
database "Algo OB\nStateful" as AlgoOB
database "ASA OB\nStateful" as ASAOB
note over AlgoEscrow: ALGO reserved for buy
note over ASAEscrow: Min .5 ALGO bal.\n+ ASA to sell

group "Placing an Algo Escrow Order: Orderbook Opt-In & Registration"
autonumber 0
Buyer -> AlgoEscrow: Pay from order creator to escrow
note right: send X ALGO\nto pay for Y ASA
AlgoEscrow -> AlgoOB: [if necessary] App opt-in
note left: TEAL attached\nfor spend approval
Buyer -> Buyer: [if necessary] Opt-in to ASA to buy
end

@enduml
